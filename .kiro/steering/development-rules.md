# 開発・作業ルール

## 概要

DeepWiki-Open-MultiRepo（DeepWiki-OMR）プロジェクトの開発・作業における基本ルールと標準を定義します。

## 言語とドキュメント

### 基本方針
- **すべてのドキュメント、コメント、変数名、関数名は日本語で記述する**
- コードのコメントも日本語で記述する
- READMEファイルやAPI仕様書も日本語で作成する
- エラーメッセージやログメッセージも日本語で出力する

### 例外
- プログラミング言語の予約語やライブラリ名は英語のまま使用
- 外部APIやサードパーティライブラリのインターフェースは元の言語に従う
- GitHubのコミットメッセージは日本語で記述

## コーディング規約

### ファイル・ディレクトリ命名
- ファイル名：snake_case（例：`リポジトリ_管理.py`）
- ディレクトリ名：kebab-case（例：`wiki-生成`）
- クラス名：PascalCase（例：`リポジトリ管理者`）
- 関数名・変数名：snake_case（例：`リポジトリを登録する`）

### コメント規約
```python
# 良い例
def リポジトリを登録する(プロバイダー: str, リモートURL: str) -> bool:
    """
    新しいリポジトリをシステムに登録する
    
    Args:
        プロバイダー: GitHubまたはCodeCommit
        リモートURL: リポジトリのURL
        
    Returns:
        登録成功時はTrue、失敗時はFalse
    """
    # リポジトリURLの妥当性を検証
    if not URL妥当性を検証(リモートURL):
        return False
    
    # データベースに保存
    return データベースに保存(プロバイダー, リモートURL)
```

## プロジェクト構造

### ディレクトリ構成
```
DeepWiki-OMR/
├── api/                    # バックエンドAPI
│   ├── モデル/             # データモデル
│   ├── サービス/           # ビジネスロジック
│   ├── リポジトリ/         # データアクセス層
│   └── API/               # REST APIエンドポイント
├── src/                   # フロントエンド
│   ├── コンポーネント/     # Reactコンポーネント
│   ├── ページ/             # Next.jsページ
│   └── ユーティリティ/     # 共通関数
├── インフラ/               # AWS CDK/Terraform
├── テスト/                 # テストコード
└── ドキュメント/           # プロジェクトドキュメント
```

## Git運用ルール

### ブランチ戦略
- `main`: 本番環境用
- `develop`: 開発統合用
- `feature/機能名`: 機能開発用
- `hotfix/修正内容`: 緊急修正用

### コミットメッセージ
```
種別: 簡潔な説明

詳細な説明（必要に応じて）

例：
feat: リポジトリ登録機能を追加
fix: Wiki生成時のエラーハンドリングを修正
docs: API仕様書を更新
```

### コミット種別
- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメント更新
- `style`: コードフォーマット
- `refactor`: リファクタリング
- `test`: テスト追加・修正
- `chore`: その他の作業

## テスト戦略

### テストレベル
1. **単体テスト**: 各関数・クラスの動作確認
2. **統合テスト**: API間の連携確認
3. **E2Eテスト**: ユーザーシナリオの確認

### テストファイル命名
- 単体テスト: `test_機能名.py`
- 統合テスト: `integration_test_機能名.py`
- E2Eテスト: `e2e_test_シナリオ名.py`

## セキュリティガイドライン

### 機密情報管理
- 認証情報はAWS Secrets Managerに保存
- 環境変数での機密情報の直接指定は禁止
- ログ出力時は機密情報をマスキング

### コードレビュー
- すべてのプルリクエストは最低1名のレビューが必要
- セキュリティに関わる変更は2名以上のレビューが必要
- 自動テストが通過していることを確認

## パフォーマンス要件

### 応答時間目標
- 全文検索: p95 < 1.0秒
- RAG検索: p95 < 4.0秒
- Wiki表示: p95 < 2.0秒
- リポジトリ登録: p95 < 3.0秒

### リソース使用量
- メモリ使用量の監視とアラート設定
- CPU使用率の最適化
- データベースクエリの最適化

## 監視・ログ

### ログレベル
- `ERROR`: システムエラー、例外
- `WARN`: 警告、パフォーマンス劣化
- `INFO`: 重要な処理の開始・終了
- `DEBUG`: 詳細なデバッグ情報

### メトリクス監視
- API応答時間
- エラー率
- リソース使用量
- ジョブ処理状況

## 開発環境

### 必須ツール
- Python 3.11+
- Node.js 18+
- Docker
- AWS CLI
- Git

### 推奨IDE設定
- VSCode with Japanese Language Pack
- Python拡張機能
- TypeScript拡張機能
- AWS Toolkit

## リリース管理

### バージョニング
- セマンティックバージョニング（例：1.2.3）
- メジャー.マイナー.パッチ形式

### リリースノート
- 新機能の説明
- バグ修正の詳細
- 破壊的変更の警告
- 移行手順（必要に応じて）